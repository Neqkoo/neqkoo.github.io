<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Raw AES-256 Pad</title>
<style>
html,body{height:100%}
body{background:#dcdcdc;font-family:Tahoma,Arial,Helvetica,sans-serif;color:#222;margin:0}
.wrap{width:820px;max-width:92%;margin:40px auto;background:#f7f7f7;border:1px solid #bbb;box-shadow:0 0 0 4px #fff inset,0 0 30px rgba(0,0,0,.2)}
.head{padding:14px 18px;background:#e5e5e5;border-bottom:1px solid #bbb;background-image:linear-gradient(#f9f9f9,#e3e3e3)}
.head h1{margin:0;font-size:20px;letter-spacing:.5px;text-shadow:0 1px 0 #fff}
.body{padding:18px}
label{display:block;font-size:12px;text-transform:uppercase;letter-spacing:.1em;color:#444;margin-bottom:6px}
textarea{width:100%;height:240px;resize:vertical;border:1px solid #999;background:#fff;font-family:Consolas,Monaco,"Courier New",monospace;padding:10px;box-shadow:inset 0 1px 3px rgba(0,0,0,.15)}
input[type=text]{width:100%;border:1px solid #999;background:#fff;padding:10px;font-size:14px}
.row{margin-bottom:16px}
.keygrid{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:start}
.buttons{display:flex;gap:10px;align-items:center}
button{border:1px solid #7b7b7b;background:#e9e9e9;background-image:linear-gradient(#fff,#d9d9d9);padding:9px 14px;font-weight:bold;font-size:13px;text-transform:uppercase;letter-spacing:.05em;cursor:pointer;box-shadow:0 1px 0 #fff inset,0 1px 2px rgba(0,0,0,.2)}
button:active{transform:translateY(1px)}
.small{font-size:12px;color:#555}
.status{min-height:18px;font-size:12px;color:#064}
.error{color:#900}
.footer{padding:10px 18px;border-top:1px solid #bbb;background:#eee;color:#555;font-size:12px}
a{color:#06c;text-decoration:none}
a:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="wrap">
<div class="head"><h1>Raw AES-256 Pad</h1></div>
<div class="body">
<div class="row">
<label for="io">Text / Encrypted</label>
<textarea id="io" placeholder="Type text here, or paste encrypted data starting with v1."></textarea>
</div>
<div class="row keygrid">
<div>
<label for="key">Key</label>
<input id="key" type="text" placeholder="Any length: passphrase or generated key" autocomplete="off" spellcheck="false">
</div>
<div class="buttons">
<button id="gen">Generate Key</button>
</div>
</div>
<div class="row buttons">
<button id="enc">Encrypt</button>
<button id="dec">Decrypt</button>
<span id="msg" class="status" aria-live="polite"></span>
</div>
<div class="small">Format: v1.[salt].[iv].[ciphertext] (Base64). Keep your key safe.</div>
</div>
<div class="footer">Runs locally in your browser using AES-256 GCM with PBKDF2-SHA256.</div>
</div>
<script>
const io=document.getElementById("io")
const keyEl=document.getElementById("key")
const gen=document.getElementById("gen")
const enc=document.getElementById("enc")
const dec=document.getElementById("dec")
const msg=document.getElementById("msg")
function t(s){return new TextEncoder().encode(s)}
function f(b){return new TextDecoder().decode(b)}
function b2b64(u){let s="";for(let i=0;i<u.length;i++)s+=String.fromCharCode(u[i]);return btoa(s)}
function b642b(a){let s=atob(a),u=new Uint8Array(s.length);for(let i=0;i<s.length;i++)u[i]=s.charCodeAt(i);return u}
async function derive(pass,salt,iter){const base=await crypto.subtle.importKey("raw",t(pass),"PBKDF2",false,["deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:salt,iterations:iter,hash:"SHA-256"},base,{name:"AES-GCM",length:256},false,["encrypt","decrypt"])}
function ok(x){msg.className="status";msg.textContent=x}
function fail(x){msg.className="status error";msg.textContent=x}
gen.onclick=()=>{const r=new Uint8Array(32);crypto.getRandomValues(r);keyEl.value=b2b64(r);ok("Generated 256-bit key")}
enc.onclick=async()=>{try{if(!crypto.subtle)return fail("Crypto not available");const pass=keyEl.value;const plain=io.value;if(!plain)return fail("Nothing to encrypt");const salt=new Uint8Array(16);crypto.getRandomValues(salt);const iv=new Uint8Array(12);crypto.getRandomValues(iv);const k=await derive(pass,salt,150000);const ct=await crypto.subtle.encrypt({name:"AES-GCM",iv:iv},k,t(plain));const out="v1."+b2b64(salt)+"."+b2b64(iv)+"."+b2b64(new Uint8Array(ct));io.value=out;ok("Encrypted")}
catch(e){fail("Encrypt error")}}
dec.onclick=async()=>{try{if(!crypto.subtle)return fail("Crypto not available");const pass=keyEl.value;const raw=io.value.trim();if(!raw)return fail("Nothing to decrypt");const parts=raw.split(".");if(parts.length!==4||parts[0]!=="v1")return fail("Invalid format");const salt=b642b(parts[1]);const iv=b642b(parts[2]);const ct=b642b(parts[3]);const k=await derive(pass,salt,150000);const pt=await crypto.subtle.decrypt({name:"AES-GCM",iv:iv},k,ct);io.value=f(pt);ok("Decrypted")}
catch(e){fail("Decrypt error")}}
</script>
</body>
</html>
